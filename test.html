<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Senarai Perkhidmatan Penduduk</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#1a1a1a; }
    h1 { text-align:center; padding:20px; background:#0078D7; color:white; margin:0; }
    .container { display:flex; flex-wrap:wrap; justify-content:center; padding:20px; gap:20px; }

    /* Kad gaya Uiverse adaptasi */
    .card {
      width: 300px;
      min-height: 220px;
      background: #243137;
      position: relative;
      border-radius: 10px;
      overflow: hidden;
      transition: all 0.5s ease-in-out;
      padding: 15px;
      color: #f0f0f0;
      box-sizing: border-box;
    }
    .card:hover {
      border-radius: 0;
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(189,159,103,0.6);
    }
    .card p { margin:6px 0; font-size:14px; }
    .label { font-weight:bold; color:#bd9f67; }

    /* Butang emas */
    .btn-link {
      display:inline-block;
      margin-top:8px;
      padding:8px 14px;
      background:#bd9f67;
      color:#243137;
      font-weight:bold;
      border-radius:6px;
      text-decoration:none;
      transition: all 0.3s ease;
    }
    .btn-link:hover {
      background:#e0c78f;
      color:#000;
    }
  </style>
</head>
<body>
  <h1>Senarai Perkhidmatan Penduduk</h1>
  <div class="container" id="directory"></div>

  <!-- PapaParse CDN -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <script>
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRaIC8vSqefzEVD6ndgQecCNLOb-mNdCtUZMAC_ojDvgDD-mCAnPBVgdLfYlUW7ehK73e8-1KIl4AKZ/pub?gid=1819529203&single=true&output=csv";

    Papa.parse(csvUrl, {
      download: true,
      header: true,
      complete: function(results) {
        const data = results.data;
        let html = "";

        data.forEach((row) => {
          // Normalisasi key → lowercase + trim
          const normalized = {};
          for (let key in row) {
            if (row.hasOwnProperty(key)) {
              normalized[key.trim().toLowerCase()] = row[key]?.trim();
            }
          }

          const namaSyarikat = normalized["nama syarikat"];
          const nama = normalized["nama"];
          const telefon = normalized["nombor telefon syarikat"];
          const status = normalized["status dalam syarikat"];
          const bidang = normalized["bidang"];
          const subBidang = normalized["sub-bidang"];
          const butiran = normalized["butiran perkhidmatan"];
          const picKad = normalized["pic kad"];

          // ❗ Skip kalau tiada "Nama"
          if (!nama) return;

          let card = `
            <div class="card">
              ${namaSyarikat ? `<p><span class="label">Nama Syarikat:</span> ${namaSyarikat}</p>` : ""}
              <p><span class="label">Nama:</span> ${nama}</p>
              ${telefon ? `<p><span class="label">Telefon:</span> ${telefon}</p>` : ""}
              ${status ? `<p><span class="label">Status:</span> ${status}</p>` : ""}
              ${bidang ? `<p><span class="label">Bidang:</span> ${bidang}</p>` : ""}
              ${subBidang ? `<p><span class="label">Sub-bidang:</span> ${subBidang}</p>` : ""}
              ${butiran ? `<p><span class="label">Butiran:</span> ${butiran}</p>` : ""}
              ${picKad ? `<a href="${picKad}" target="_blank" class="btn-link">Lihat Kad</a>` : ""}
            </div>
          `;
          html += card;
        });

        document.getElementById("directory").innerHTML = html;
      }
    });
  </script>
</body>
</html>
